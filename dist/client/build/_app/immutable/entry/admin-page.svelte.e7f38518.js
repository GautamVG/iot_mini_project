import{S as X,i as Y,s as Z,k,a as C,q as D,l as v,m as b,h as p,c as x,r as V,n as E,J as L,b as I,G as h,u as M,g as y,H as S,K as U,L as tt,e as et,v as it,f as rt,d as O,N as ht,y as J,z as K,A as Q,B as W,M as st,O as mt,o as dt}from"../chunks/index.4cec945a.js";import{f as T,S as gt}from"../chunks/ArrowUp.svelte_svelte_type_style_lang.d5fc16c5.js";import{_ as kt}from"../chunks/preload-helper.41c905a7.js";function vt(c){let t,l,i;return{c(){t=k("p"),l=D("FREE"),this.h()},l(e){t=v(e,"P",{class:!0});var a=b(t);l=V(a,"FREE"),a.forEach(p),this.h()},h(){E(t,"class","text-sm")},m(e,a){I(e,t,a),h(t,l)},p:S,i(e){i||U(()=>{i=tt(t,T,{}),i.start()})},o:S,d(e){e&&p(t)}}}function bt(c){let t,l,i,e,a,s=c[1]&&ot(c);return{c(){t=k("p"),l=D("OCCUPIED"),e=C(),s&&s.c(),a=et(),this.h()},l(r){t=v(r,"P",{class:!0});var n=b(t);l=V(n,"OCCUPIED"),n.forEach(p),e=x(r),s&&s.l(r),a=et(),this.h()},h(){E(t,"class","text-sm")},m(r,n){I(r,t,n),h(t,l),I(r,e,n),s&&s.m(r,n),I(r,a,n)},p(r,n){r[1]?s?(s.p(r,n),n&2&&y(s,1)):(s=ot(r),s.c(),y(s,1),s.m(a.parentNode,a)):s&&(s.d(1),s=null)},i(r){i||U(()=>{i=tt(t,T,{}),i.start()}),y(s)},o:S,d(r){r&&p(t),r&&p(e),s&&s.d(r),r&&p(a)}}}function ot(c){let t,l,i,e,a=c[1].start_time+"",s,r,n,f,_,o=c[1].parking_fee+"",u,d;return{c(){t=k("p"),l=D("Parked at: "),i=k("br"),e=C(),s=D(a),n=C(),f=k("p"),_=D("Fee: "),u=D(o),this.h()},l(m){t=v(m,"P",{class:!0});var g=b(t);l=V(g,"Parked at: "),i=v(g,"BR",{}),e=x(g),s=V(g,a),g.forEach(p),n=x(m),f=v(m,"P",{class:!0});var A=b(f);_=V(A,"Fee: "),u=V(A,o),A.forEach(p),this.h()},h(){E(t,"class","text-sm mt-4 text-center"),E(f,"class","text-sm")},m(m,g){I(m,t,g),h(t,l),h(t,i),h(t,e),h(t,s),I(m,n,g),I(m,f,g),h(f,_),h(f,u)},p(m,g){g&2&&a!==(a=m[1].start_time+"")&&M(s,a),g&2&&o!==(o=m[1].parking_fee+"")&&M(u,o)},i(m){r||U(()=>{r=tt(t,T,{}),r.start()}),d||U(()=>{d=tt(f,T,{}),d.start()})},o:S,d(m){m&&p(t),m&&p(n),m&&p(f)}}}function Et(c){let t,l,i,e,a=c[0].name+"",s,r;function n(o,u){return o[0].occupied?bt:vt}let f=n(c),_=f(c);return{c(){t=k("div"),l=k("div"),i=C(),e=k("p"),s=D(a),r=C(),_.c(),this.h()},l(o){t=v(o,"DIV",{class:!0});var u=b(t);l=v(u,"DIV",{class:!0}),b(l).forEach(p),i=x(u),e=v(u,"P",{class:!0});var d=b(e);s=V(d,a),d.forEach(p),r=x(u),_.l(u),u.forEach(p),this.h()},h(){E(l,"class","flipper absolute w-full h-full -z-10 svelte-164a57p"),L(l,"bg-primary",!c[0].occupied),L(l,"bg-error",c[0].occupied),L(l,"occupied",c[0].occupied),E(e,"class","text-lg font-bold"),E(t,"class","rounded-lg px-4 py-12 flex flex-col items-center justify-center w-full relative overflow-hidden")},m(o,u){I(o,t,u),h(t,l),h(t,i),h(t,e),h(e,s),h(t,r),_.m(t,null)},p(o,[u]){u&1&&L(l,"bg-primary",!o[0].occupied),u&1&&L(l,"bg-error",o[0].occupied),u&1&&L(l,"occupied",o[0].occupied),u&1&&a!==(a=o[0].name+"")&&M(s,a),f===(f=n(o))&&_?_.p(o,u):(_.d(1),_=f(o),_&&(_.c(),y(_,1),_.m(t,null)))},i(o){y(_)},o:S,d(o){o&&p(t),_.d()}}}function wt(c,t,l){let{spot:i}=t,{ticket:e}=t;return c.$$set=a=>{"spot"in a&&l(0,i=a.spot),"ticket"in a&&l(1,e=a.ticket)},[i,e]}class yt extends X{constructor(t){super(),Y(this,t,wt,Et,Z,{spot:0,ticket:1})}}function ft(c,t,l){const i=c.slice();return i[3]=t[l],i}function ut(c){let t,l;return t=new yt({props:{spot:c[3].spot,ticket:c[3].ticket}}),{c(){J(t.$$.fragment)},l(i){K(t.$$.fragment,i)},m(i,e){Q(t,i,e),l=!0},p(i,e){const a={};e&1&&(a.spot=i[3].spot),e&1&&(a.ticket=i[3].ticket),t.$set(a)},i(i){l||(y(t.$$.fragment,i),l=!0)},o(i){O(t.$$.fragment,i),l=!1},d(i){W(t,i)}}}function Pt(c){let t,l,i=c[0],e=[];for(let s=0;s<i.length;s+=1)e[s]=ut(ft(c,i,s));const a=s=>O(e[s],1,1,()=>{e[s]=null});return{c(){t=k("div");for(let s=0;s<e.length;s+=1)e[s].c();this.h()},l(s){t=v(s,"DIV",{class:!0});var r=b(t);for(let n=0;n<e.length;n+=1)e[n].l(r);r.forEach(p),this.h()},h(){E(t,"class","grid grid-cols-3 gap-16 w-full")},m(s,r){I(s,t,r);for(let n=0;n<e.length;n+=1)e[n]&&e[n].m(t,null);l=!0},p(s,[r]){if(r&1){i=s[0];let n;for(n=0;n<i.length;n+=1){const f=ft(s,i,n);e[n]?(e[n].p(f,r),y(e[n],1)):(e[n]=ut(f),e[n].c(),y(e[n],1),e[n].m(t,null))}for(it(),n=i.length;n<e.length;n+=1)a(n);rt()}},i(s){if(!l){for(let r=0;r<i.length;r+=1)y(e[r]);l=!0}},o(s){e=e.filter(Boolean);for(let r=0;r<e.length;r+=1)O(e[r]);l=!1},d(s){s&&p(t),ht(e,s)}}}function It(c,t,l){let{spots:i}=t,{tickets:e}=t,a;return c.$$set=s=>{"spots"in s&&l(1,i=s.spots),"tickets"in s&&l(2,e=s.tickets)},c.$$.update=()=>{c.$$.dirty&6&&l(0,a=i.map(s=>{let r=null;return s.occupied&&(r=e.find(n=>n.parking_spot_name==s.name)??null),{spot:s,ticket:r}}))},[a,i,e]}class Dt extends X{constructor(t){super(),Y(this,t,It,Pt,Z,{spots:1,tickets:2})}}function _t(c,t,l){const i=c.slice();return i[4]=t[l],i}function pt(c){let t,l,i=c[4].figure+"",e,a,s,r=c[4].caption+"",n,f,_,o;return{c(){t=k("div"),l=k("div"),e=D(i),a=C(),s=k("div"),n=D(r),f=C(),this.h()},l(u){t=v(u,"DIV",{class:!0});var d=b(t);l=v(d,"DIV",{class:!0});var m=b(l);e=V(m,i),m.forEach(p),a=x(d),s=v(d,"DIV",{class:!0});var g=b(s);n=V(g,r),g.forEach(p),f=x(d),d.forEach(p),this.h()},h(){E(l,"class","text-primary-content text-4xl font-bold"),E(s,"class","text-primary-content text-xl"),E(t,"class","bg-primary rounded-lg px-16 py-8 flex flex-col items-center gap-4")},m(u,d){I(u,t,d),h(t,l),h(l,e),h(t,a),h(t,s),h(s,n),h(t,f),o=!0},p(u,d){(!o||d&1)&&i!==(i=u[4].figure+"")&&M(e,i),(!o||d&1)&&r!==(r=u[4].caption+"")&&M(n,r)},i(u){o||(U(()=>{o&&(_||(_=st(t,T,{},!0)),_.run(1))}),o=!0)},o(u){_||(_=st(t,T,{},!1)),_.run(0),o=!1},d(u){u&&p(t),u&&_&&_.end()}}}function Vt(c){let t,l,i=c[0],e=[];for(let s=0;s<i.length;s+=1)e[s]=pt(_t(c,i,s));const a=s=>O(e[s],1,1,()=>{e[s]=null});return{c(){t=k("div");for(let s=0;s<e.length;s+=1)e[s].c();this.h()},l(s){t=v(s,"DIV",{class:!0});var r=b(t);for(let n=0;n<e.length;n+=1)e[n].l(r);r.forEach(p),this.h()},h(){E(t,"class","grid grid-cols-2 w-full gap-8")},m(s,r){I(s,t,r);for(let n=0;n<e.length;n+=1)e[n]&&e[n].m(t,null);l=!0},p(s,[r]){if(r&1){i=s[0];let n;for(n=0;n<i.length;n+=1){const f=_t(s,i,n);e[n]?(e[n].p(f,r),y(e[n],1)):(e[n]=pt(f),e[n].c(),y(e[n],1),e[n].m(t,null))}for(it(),n=i.length;n<e.length;n+=1)a(n);rt()}},i(s){if(!l){for(let r=0;r<i.length;r+=1)y(e[r]);l=!0}},o(s){e=e.filter(Boolean);for(let r=0;r<e.length;r+=1)O(e[r]);l=!1},d(s){s&&p(t),ht(e,s)}}}function Ct(c,t,l){let i,e,{receipts:a}=t,s=0;return c.$$set=r=>{"receipts"in r&&l(1,a=r.receipts)},c.$$.update=()=>{c.$$.dirty&2&&l(3,i=a.length),c.$$.dirty&6&&(l(2,s=0),a.forEach(r=>l(2,s+=r.payed?r.amount:0))),c.$$.dirty&12&&l(0,e=[{figure:i,caption:"Vehicles parked"},{figure:s,caption:"Amount earned"}])},[e,a,s,i]}class xt extends X{constructor(t){super(),Y(this,t,Ct,Vt,Z,{receipts:1})}}function Ot(c,t){let l;return(async()=>{const i=(await kt(()=>import("../chunks/apexcharts.common.da8142ea.js").then(e=>e.a),[],import.meta.url)).default;l=new i(c,t),l.render()})(),{update(i){l.updateOptions(t),l.render()}}}function St(c){let t,l,i;return{c(){t=k("div"),this.h()},l(e){t=v(e,"DIV",{class:!0}),b(t).forEach(p),this.h()},h(){E(t,"class","w-full")},m(e,a){I(e,t,a),l||(i=mt(Ot.call(null,t,c[0])),l=!0)},p:S,i:S,o:S,d(e){e&&p(t),l=!1,i()}}}function jt(c,t,l){let{receipts:i}=t,{bin_start:e=0}=t,{bin_gap:a=5}=t,{bin_count:s=10}=t;const r=[];let n=e;for(let o=0;o<s;o++)r.push(`${n}-${n+a}`),n+=a;const f=[];n=e;for(let o=0;o<s;o++){const u=i.filter(d=>d.time_parked>n&&d.time_parked<n+a).length;f.push(u),n+=a}let _={chart:{type:"bar"},series:[{name:"Parking times",data:f}],xaxis:{categories:r}};return c.$$set=o=>{"receipts"in o&&l(1,i=o.receipts),"bin_start"in o&&l(2,e=o.bin_start),"bin_gap"in o&&l(3,a=o.bin_gap),"bin_count"in o&&l(4,s=o.bin_count)},[_,i,e,a,s]}class Nt extends X{constructor(t){super(),Y(this,t,jt,St,Z,{receipts:1,bin_start:2,bin_gap:3,bin_count:4})}}function Rt(c){var at;let t,l,i,e=((at=c[0])==null?void 0:at.parking_fee)+"",a,s,r,n,f,_,o,u,d,m,g,A,j,H,lt,nt,N,R,q;return f=new xt({props:{receipts:c[3]}}),g=new Dt({props:{spots:c[1],tickets:c[2]}}),N=new Nt({props:{receipts:c[3]}}),{c(){t=k("div"),l=k("h1"),i=D("Current parking fees: "),a=D(e),s=D(" rs. / minute"),r=C(),n=k("section"),J(f.$$.fragment),_=C(),o=k("section"),u=k("h1"),d=D("Parking spots"),m=C(),J(g.$$.fragment),A=C(),j=k("section"),H=k("h1"),lt=D("Parking times"),nt=C(),J(N.$$.fragment),this.h()},l(w){t=v(w,"DIV",{class:!0});var P=b(t);l=v(P,"H1",{class:!0});var B=b(l);i=V(B,"Current parking fees: "),a=V(B,e),s=V(B," rs. / minute"),B.forEach(p),r=x(P),n=v(P,"SECTION",{class:!0});var z=b(n);K(f.$$.fragment,z),z.forEach(p),_=x(P),o=v(P,"SECTION",{class:!0});var F=b(o);u=v(F,"H1",{class:!0});var G=b(u);d=V(G,"Parking spots"),G.forEach(p),m=x(F),K(g.$$.fragment,F),F.forEach(p),A=x(P),j=v(P,"SECTION",{class:!0});var $=b(j);H=v($,"H1",{class:!0});var ct=b(H);lt=V(ct,"Parking times"),ct.forEach(p),nt=x($),K(N.$$.fragment,$),$.forEach(p),P.forEach(p),this.h()},h(){E(l,"class","text-3xl"),E(n,"class","svelte-cbnooh"),E(u,"class","section-title svelte-cbnooh"),E(o,"class","svelte-cbnooh"),E(H,"class","section-title svelte-cbnooh"),E(j,"class","svelte-cbnooh"),E(t,"class","flex flex-col gap-8 items-center mx-auto my-16 w-1/2")},m(w,P){I(w,t,P),h(t,l),h(l,i),h(l,a),h(l,s),h(t,r),h(t,n),Q(f,n,null),h(t,_),h(t,o),h(o,u),h(u,d),h(o,m),Q(g,o,null),h(t,A),h(t,j),h(j,H),h(H,lt),h(j,nt),Q(N,j,null),q=!0},p(w,P){var G;(!q||P&1)&&e!==(e=((G=w[0])==null?void 0:G.parking_fee)+"")&&M(a,e);const B={};P&8&&(B.receipts=w[3]),f.$set(B);const z={};P&2&&(z.spots=w[1]),P&4&&(z.tickets=w[2]),g.$set(z);const F={};P&8&&(F.receipts=w[3]),N.$set(F)},i(w){q||(y(f.$$.fragment,w),y(g.$$.fragment,w),y(N.$$.fragment,w),U(()=>{q&&(R||(R=st(t,T,{},!0)),R.run(1))}),q=!0)},o(w){O(f.$$.fragment,w),O(g.$$.fragment,w),O(N.$$.fragment,w),R||(R=st(t,T,{},!1)),R.run(0),q=!1},d(w){w&&p(t),W(f),W(g),W(N),w&&R&&R.end()}}}function Tt(c){let t,l,i;return l=new gt({props:{size:48}}),{c(){t=k("div"),J(l.$$.fragment),this.h()},l(e){t=v(e,"DIV",{class:!0});var a=b(t);K(l.$$.fragment,a),a.forEach(p),this.h()},h(){E(t,"class","w-screen h-screen flex justify-center items-center")},m(e,a){I(e,t,a),Q(l,t,null),i=!0},p:S,i(e){i||(y(l.$$.fragment,e),i=!0)},o(e){O(l.$$.fragment,e),i=!1},d(e){e&&p(t),W(l)}}}function At(c){let t,l,i,e;const a=[Tt,Rt],s=[];function r(n,f){return n[4]?1:0}return t=r(c),l=s[t]=a[t](c),{c(){l.c(),i=et()},l(n){l.l(n),i=et()},m(n,f){s[t].m(n,f),I(n,i,f),e=!0},p(n,[f]){let _=t;t=r(n),t===_?s[t].p(n,f):(it(),O(s[_],1,1,()=>{s[_]=null}),rt(),l=s[t],l?l.p(n,f):(l=s[t]=a[t](n),l.c()),y(l,1),l.m(i.parentNode,i))},i(n){e||(y(l),e=!0)},o(n){O(l),e=!1},d(n){s[t].d(n),n&&p(i)}}}function Bt(c,t,l){let i,e=0,a,s=[],r=[],n=[];dt(()=>{f();let m=setInterval(_,10);return()=>clearInterval(m)});async function f(){const m=await fetch("/api/config");l(0,a=await m.json())}function _(){o(),u(),d()}async function o(){console.log("hi");const m=await fetch("/api/spots/list");l(1,s=await m.json()),l(5,e++,e)}async function u(){console.log("hiaa");const m=await fetch("/api/tickets/list");l(2,r=await m.json()),l(5,e++,e)}async function d(){console.log("hiee");const m=await fetch("/api/receipts/list");l(3,n=await m.json()),l(5,e++,e)}return c.$$.update=()=>{c.$$.dirty&32&&l(4,i=e>=3)},[a,s,r,n,i,e]}class zt extends X{constructor(t){super(),Y(this,t,Bt,At,Z,{})}}export{zt as default};
